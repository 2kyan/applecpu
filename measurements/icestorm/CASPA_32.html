<html><head><title>Icestorm: CASPA (32-bit) measurements</title></head><body><style>body { background-color: #E7F2F8 }</style>
		<style>
		input[type=checkbox] {
			display: none;
		}
		input[type=checkbox]:checked ~ .remove-check {
		    display: none;
		}
		input[type=checkbox] ~ label > p::before {
			content: "\25BC\A0";
			width: 50px;
		font-family: "Arial", monospace;
		}
		input[type=checkbox]:checked ~ label > p::before {
			content: "\25BA\A0";
			width: 50px;
			font-family: "Arial", monospace;
		}
		pre { margin: 0; }
		label {
			cursor: pointer;
		}
		.clicky {
			text-decoration: underline;
		}
		td {
			text-align: right;
		}
		thead > tr > td {
			font-weight: bold;
			text-align: center;
		}
		</style>
		<pre><strong>Apple M1 Microarchitecture Research</strong> by <a href="https://twitter.com/dougallj">Dougall Johnson</a>

Firestorm: <a href="../../firestorm.html">Overview</a> | <a href="../../firestorm-int.html">Base Instructions</a> | <a href="../../firestorm-simd.html">SIMD and FP Instructions</a>
Icestorm:  <a href="../../icestorm.html">Overview</a> | <a href="../../icestorm-int.html">Base Instructions</a> | <a href="../../icestorm-simd.html">SIMD and FP Instructions</a>

</pre><h1>CASPA (32-bit)</h1><h2>Test 1: uops</h2><div style="margin-left: 40px"><p>Code:</p><pre>  caspa w0, w1, w2, w3, [x6]
  nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop ; nop</pre><div><input type="checkbox" id="checkbox-0" checked="checked"><label for="checkbox-0"><p>Initialization</p></label><div class="remove-check">
<pre>  mov x0, 0</pre></div></div><p>(no loop instructions)</p><h3>1000 unrolls and 1 iteration</h3><div style="margin-left: 40px"><p>Retires (minus 70 nops): 6.000</p><p>Issues: 3.000</p><p>Integer unit issues: 0.001</p><p>Load/store unit issues: 3.000</p><p>SIMD/FP unit issues: 0.000</p><div><input type="checkbox" id="checkbox-1" checked="checked"><label for="checkbox-1"><p>Recorded non-zero counters (first 10 of 64 runs)</p></label><div class="remove-check">
<table><thead><tr><td>retire (01)</td><td>cycle (02)</td><td>inst issue (52)</td><td>~issue int (53)</td><td>~issue ld/st (55)</td><td>~dispatch ld/st (58)</td><td>huge thing int (59)</td><td>huge thing ld/st (5a)</td><td>~dispatch op (78)</td><td>~map op int (7c)</td><td>~map op ld/st (7d)</td><td>~map lookup int (7f)</td><td>~map lookup ld/st (80)</td><td>? int output thing (e9)</td><td>ld/st retires (ed)</td><td>gpr retires (ef)</td></tr></thead><tr><td>76007</td><td>34882</td><td>3007</td><td>1</td><td>3006</td><td>3000</td><td>0</td><td>11001</td><td>3000</td><td>2000</td><td>4000</td><td>2000</td><td>7000</td><td>1</td><td>3000</td><td>3000</td></tr><tr><td>76004</td><td>34512</td><td>3001</td><td>1</td><td>3000</td><td>3000</td><td>0</td><td>11001</td><td>3000</td><td>2000</td><td>4000</td><td>2000</td><td>7000</td><td>1</td><td>3000</td><td>3000</td></tr><tr><td>76004</td><td>34498</td><td>3001</td><td>1</td><td>3000</td><td>3000</td><td>0</td><td>11001</td><td>3000</td><td>2000</td><td>4000</td><td>2000</td><td>7000</td><td>1</td><td>3000</td><td>3000</td></tr><tr><td>76004</td><td>34501</td><td>3001</td><td>1</td><td>3000</td><td>3000</td><td>0</td><td>11001</td><td>3000</td><td>2000</td><td>4000</td><td>2000</td><td>7000</td><td>1</td><td>3000</td><td>3000</td></tr><tr><td>76004</td><td>34441</td><td>3001</td><td>1</td><td>3000</td><td>3000</td><td>0</td><td>11001</td><td>3000</td><td>2000</td><td>4000</td><td>2000</td><td>7000</td><td>1</td><td>3000</td><td>3000</td></tr><tr><td>76004</td><td>34583</td><td>3001</td><td>1</td><td>3000</td><td>3000</td><td>0</td><td>11001</td><td>3000</td><td>2000</td><td>4000</td><td>2000</td><td>7000</td><td>1</td><td>3000</td><td>3000</td></tr><tr><td>76005</td><td>34622</td><td>3004</td><td>1</td><td>3003</td><td>3000</td><td>0</td><td>11007</td><td>3000</td><td>2000</td><td>4000</td><td>2002</td><td>7007</td><td>1</td><td>3000</td><td>3000</td></tr><tr><td>76004</td><td>34444</td><td>3001</td><td>1</td><td>3000</td><td>3000</td><td>0</td><td>11001</td><td>3000</td><td>2000</td><td>4000</td><td>2000</td><td>7000</td><td>1</td><td>3000</td><td>3000</td></tr><tr><td>76004</td><td>34535</td><td>3001</td><td>1</td><td>3000</td><td>3000</td><td>0</td><td>11001</td><td>3000</td><td>2000</td><td>4000</td><td>2000</td><td>7000</td><td>1</td><td>3000</td><td>3000</td></tr><tr><td>76004</td><td>34496</td><td>3001</td><td>1</td><td>3000</td><td>3000</td><td>0</td><td>11001</td><td>3000</td><td>2000</td><td>4000</td><td>2000</td><td>7000</td><td>1</td><td>3000</td><td>3000</td></tr></table></div></div></div></div><h2>Test 2: throughput</h2><div style="margin-left: 40px"><p>Code:</p><pre>  caspa w0, w1, w2, w3, [x6]
  add x6, x6, 8</pre><p>(fused SUBS/B.cc loop)</p><h3>100 unrolls and 100 iterations</h3><div style="margin-left: 40px"><p>Result (median cycles for code): 17.0055</p><div><input type="checkbox" id="checkbox-2" checked="checked"><label for="checkbox-2"><p>Recorded non-zero counters (first 10 of 64 runs)</p></label><div class="remove-check">
<table><thead><tr><td>retire (01)</td><td>cycle (02)</td><td>inst issue (52)</td><td>~issue int (53)</td><td>~issue ld/st (55)</td><td>~dispatch int (56)</td><td>~dispatch ld/st (58)</td><td>huge thing int (59)</td><td>huge thing ld/st (5a)</td><td>~dispatch op (78)</td><td>~map op int (7c)</td><td>~map op ld/st (7d)</td><td>~map lookup int (7f)</td><td>~map lookup ld/st (80)</td><td>~map lookup fp/simd (81)</td><td>? int output thing (e9)</td><td>ld/st retires (ed)</td><td>? fp/simd (ee)</td><td>gpr retires (ef)</td></tr></thead><tr><td>70220</td><td>170603</td><td>51195</td><td>21104</td><td>30091</td><td>21051</td><td>30135</td><td>69302</td><td>646954</td><td>53056</td><td>30336</td><td>40180</td><td>30303</td><td>70238</td><td>0</td><td>22802</td><td>30000</td><td>0</td><td>40100</td></tr><tr><td>70204</td><td>170253</td><td>52935</td><td>22876</td><td>30059</td><td>22871</td><td>30069</td><td>68942</td><td>645632</td><td>52941</td><td>30268</td><td>40092</td><td>30268</td><td>70161</td><td>0</td><td>22780</td><td>30000</td><td>0</td><td>40100</td></tr><tr><td>70204</td><td>170492</td><td>53042</td><td>22925</td><td>30117</td><td>22920</td><td>30003</td><td>68665</td><td>644671</td><td>52830</td><td>30202</td><td>40004</td><td>30268</td><td>70161</td><td>0</td><td>22771</td><td>30000</td><td>0</td><td>40100</td></tr><tr><td>70204</td><td>173441</td><td>54226</td><td>23442</td><td>30784</td><td>23437</td><td>30102</td><td>68345</td><td>646032</td><td>52751</td><td>30301</td><td>40136</td><td>30202</td><td>70007</td><td>0</td><td>22732</td><td>30000</td><td>0</td><td>40100</td></tr><tr><td>70204</td><td>170052</td><td>52833</td><td>22832</td><td>30001</td><td>22827</td><td>30003</td><td>68665</td><td>644671</td><td>52830</td><td>30202</td><td>40004</td><td>30202</td><td>70007</td><td>0</td><td>22732</td><td>30000</td><td>0</td><td>40100</td></tr><tr><td>70204</td><td>170052</td><td>52833</td><td>22832</td><td>30001</td><td>22827</td><td>30003</td><td>68665</td><td>644671</td><td>52830</td><td>30202</td><td>40004</td><td>30202</td><td>70007</td><td>0</td><td>22732</td><td>30000</td><td>0</td><td>40100</td></tr><tr><td>70204</td><td>170052</td><td>52833</td><td>22832</td><td>30001</td><td>22827</td><td>30003</td><td>68665</td><td>644671</td><td>52830</td><td>30202</td><td>40004</td><td>30202</td><td>70007</td><td>0</td><td>22732</td><td>30000</td><td>0</td><td>40100</td></tr><tr><td>70205</td><td>170141</td><td>51816</td><td>21786</td><td>30030</td><td>21781</td><td>30036</td><td>64303</td><td>645134</td><td>51374</td><td>30235</td><td>40048</td><td>30202</td><td>70007</td><td>0</td><td>22732</td><td>30000</td><td>0</td><td>40100</td></tr><tr><td>70204</td><td>170052</td><td>52833</td><td>22832</td><td>30001</td><td>22827</td><td>30003</td><td>68665</td><td>644685</td><td>52830</td><td>30202</td><td>40004</td><td>30202</td><td>70007</td><td>0</td><td>22732</td><td>30000</td><td>0</td><td>40100</td></tr><tr><td>70205</td><td>170113</td><td>52246</td><td>22216</td><td>30030</td><td>22211</td><td>30003</td><td>69929</td><td>645827</td><td>52830</td><td>30202</td><td>40004</td><td>30202</td><td>70007</td><td>0</td><td>22732</td><td>30000</td><td>0</td><td>40100</td></tr></table></div></div></div><h3>1000 unrolls and 10 iterations</h3><div style="margin-left: 40px"><p>Result (median cycles for code): 17.0058</p><div><input type="checkbox" id="checkbox-3" checked="checked"><label for="checkbox-3"><p>Recorded non-zero counters (first 10 of 64 runs)</p></label><div class="remove-check">
<table><thead><tr><td>retire (01)</td><td>cycle (02)</td><td>inst issue (52)</td><td>~issue int (53)</td><td>~issue ld/st (55)</td><td>~dispatch int (56)</td><td>~dispatch ld/st (58)</td><td>huge thing int (59)</td><td>huge thing ld/st (5a)</td><td>~dispatch op (78)</td><td>~map op int (7c)</td><td>~map op ld/st (7d)</td><td>~map lookup int (7f)</td><td>~map lookup ld/st (80)</td><td>? int output thing (e9)</td><td>ld/st retires (ed)</td><td>? fp/simd (ee)</td><td>gpr retires (ef)</td></tr></thead><tr><td>70039</td><td>170591</td><td>51053</td><td>20991</td><td>30062</td><td>20938</td><td>30003</td><td>68439</td><td>644791</td><td>52740</td><td>30022</td><td>40004</td><td>30022</td><td>70007</td><td>22734</td><td>30000</td><td>0</td><td>40010</td></tr><tr><td>70025</td><td>170100</td><td>52782</td><td>22752</td><td>30030</td><td>22745</td><td>30003</td><td>68439</td><td>644754</td><td>52740</td><td>30022</td><td>40004</td><td>30022</td><td>70007</td><td>22734</td><td>30000</td><td>0</td><td>40010</td></tr><tr><td>70024</td><td>170058</td><td>52745</td><td>22744</td><td>30001</td><td>22737</td><td>30003</td><td>68439</td><td>644768</td><td>52740</td><td>30022</td><td>40004</td><td>30022</td><td>70007</td><td>22734</td><td>30000</td><td>0</td><td>40010</td></tr><tr><td>70024</td><td>170058</td><td>52745</td><td>22744</td><td>30001</td><td>22737</td><td>30003</td><td>68439</td><td>644754</td><td>52740</td><td>30022</td><td>40004</td><td>30022</td><td>70007</td><td>22734</td><td>30000</td><td>0</td><td>40010</td></tr><tr><td>70024</td><td>170058</td><td>52745</td><td>22744</td><td>30001</td><td>22737</td><td>30003</td><td>68439</td><td>644754</td><td>52740</td><td>30022</td><td>40004</td><td>30055</td><td>70084</td><td>21844</td><td>30000</td><td>0</td><td>40010</td></tr><tr><td>70024</td><td>170058</td><td>52745</td><td>22744</td><td>30001</td><td>22737</td><td>30003</td><td>68439</td><td>644754</td><td>52740</td><td>30022</td><td>40004</td><td>30022</td><td>70007</td><td>22734</td><td>30000</td><td>0</td><td>40010</td></tr><tr><td>70024</td><td>170058</td><td>52745</td><td>22744</td><td>30001</td><td>22737</td><td>30003</td><td>68439</td><td>644754</td><td>52740</td><td>30022</td><td>40004</td><td>30022</td><td>70007</td><td>22734</td><td>30000</td><td>0</td><td>40010</td></tr><tr><td>70024</td><td>170058</td><td>52745</td><td>22744</td><td>30001</td><td>22737</td><td>30003</td><td>68439</td><td>644754</td><td>52740</td><td>30022</td><td>40004</td><td>30022</td><td>70007</td><td>22734</td><td>30000</td><td>0</td><td>40010</td></tr><tr><td>70024</td><td>170058</td><td>52745</td><td>22744</td><td>30001</td><td>22737</td><td>30003</td><td>68439</td><td>644754</td><td>52740</td><td>30022</td><td>40004</td><td>30022</td><td>70007</td><td>22734</td><td>30000</td><td>0</td><td>40010</td></tr><tr><td>70024</td><td>170058</td><td>52745</td><td>22744</td><td>30001</td><td>22737</td><td>30003</td><td>68439</td><td>644754</td><td>52740</td><td>30022</td><td>40004</td><td>30022</td><td>70007</td><td>22734</td><td>30000</td><td>0</td><td>40010</td></tr></table></div></div></div></div><h2>Test 3: throughput</h2><div style="margin-left: 40px"><p>Code:</p><pre>  caspa w0, w1, w2, w3, [x6]</pre><div><input type="checkbox" id="checkbox-4" checked="checked"><label for="checkbox-4"><p>Initialization</p></label><div class="remove-check">
<pre>  mov x7, 8</pre></div></div><p>(fused SUBS/B.cc loop)</p><h3>100 unrolls and 100 iterations</h3><div style="margin-left: 40px"><p>Result (median cycles for code): 15.0251</p><div><input type="checkbox" id="checkbox-5" checked="checked"><label for="checkbox-5"><p>Recorded non-zero counters (first 10 of 64 runs)</p></label><div class="remove-check">
<table><thead><tr><td>retire (01)</td><td>cycle (02)</td><td>inst issue (52)</td><td>~issue int (53)</td><td>~issue ld/st (55)</td><td>~dispatch int (56)</td><td>~dispatch ld/st (58)</td><td>huge thing int (59)</td><td>huge thing ld/st (5a)</td><td>~dispatch op (78)</td><td>~map op int (7c)</td><td>~map op ld/st (7d)</td><td>~map lookup int (7f)</td><td>~map lookup ld/st (80)</td><td>? int output thing (e9)</td><td>ld/st retires (ed)</td><td>gpr retires (ef)</td></tr></thead><tr><td>60209</td><td>150162</td><td>51997</td><td>21959</td><td>30038</td><td>11032</td><td>30030</td><td>1781151</td><td>1694318</td><td>42868</td><td>20220</td><td>40040</td><td>20220</td><td>70070</td><td>25454</td><td>30000</td><td>30104</td></tr><tr><td>60211</td><td>150204</td><td>53811</td><td>23761</td><td>30050</td><td>11965</td><td>30078</td><td>1574724</td><td>1697387</td><td>41441</td><td>20252</td><td>40104</td><td>20220</td><td>70070</td><td>25322</td><td>30000</td><td>30104</td></tr><tr><td>60206</td><td>150340</td><td>55510</td><td>25493</td><td>30017</td><td>12836</td><td>30030</td><td>1785604</td><td>1699988</td><td>42867</td><td>20220</td><td>40040</td><td>20220</td><td>70070</td><td>25385</td><td>30000</td><td>30104</td></tr><tr><td>60208</td><td>150628</td><td>55441</td><td>25422</td><td>30019</td><td>12837</td><td>30024</td><td>1788658</td><td>1704272</td><td>42860</td><td>20216</td><td>40032</td><td>20216</td><td>70056</td><td>25322</td><td>30000</td><td>30102</td></tr><tr><td>60206</td><td>150628</td><td>55439</td><td>25422</td><td>30017</td><td>12836</td><td>30024</td><td>1784905</td><td>1699326</td><td>42860</td><td>20216</td><td>40032</td><td>20216</td><td>70056</td><td>25385</td><td>30000</td><td>30102</td></tr><tr><td>60209</td><td>150327</td><td>52846</td><td>22798</td><td>30048</td><td>11495</td><td>30024</td><td>1784905</td><td>1699326</td><td>42860</td><td>20216</td><td>40032</td><td>20216</td><td>70056</td><td>25385</td><td>30000</td><td>30102</td></tr><tr><td>60208</td><td>150052</td><td>55575</td><td>25556</td><td>30019</td><td>12837</td><td>30069</td><td>1630034</td><td>1698530</td><td>41814</td><td>20248</td><td>40092</td><td>20220</td><td>70070</td><td>25456</td><td>30000</td><td>30104</td></tr><tr><td>60208</td><td>150055</td><td>55575</td><td>25556</td><td>30019</td><td>12837</td><td>30030</td><td>1781157</td><td>1694270</td><td>42867</td><td>20220</td><td>40040</td><td>20220</td><td>70070</td><td>25456</td><td>30000</td><td>30104</td></tr><tr><td>60208</td><td>150052</td><td>55575</td><td>25556</td><td>30019</td><td>12837</td><td>30021</td><td>1782349</td><td>1692078</td><td>42858</td><td>20214</td><td>40028</td><td>20220</td><td>70070</td><td>25458</td><td>30000</td><td>30104</td></tr><tr><td>60208</td><td>150054</td><td>55575</td><td>25556</td><td>30019</td><td>12838</td><td>30030</td><td>1785015</td><td>1699237</td><td>42868</td><td>20220</td><td>40040</td><td>20220</td><td>70070</td><td>25458</td><td>30000</td><td>30104</td></tr></table></div></div></div><h3>1000 unrolls and 10 iterations</h3><div style="margin-left: 40px"><p>Result (median cycles for code): 15.0054</p><div><input type="checkbox" id="checkbox-6" checked="checked"><label for="checkbox-6"><p>Recorded non-zero counters (first 10 of 64 runs)</p></label><div class="remove-check">
<table><thead><tr><td>retire (01)</td><td>cycle (02)</td><td>inst issue (52)</td><td>~issue int (53)</td><td>~issue ld/st (55)</td><td>~dispatch int (56)</td><td>~dispatch ld/st (58)</td><td>huge thing int (59)</td><td>huge thing ld/st (5a)</td><td>~dispatch op (78)</td><td>~map op int (7c)</td><td>~map op ld/st (7d)</td><td>~map lookup int (7f)</td><td>~map lookup ld/st (80)</td><td>? int output thing (e9)</td><td>ld/st retires (ed)</td><td>gpr retires (ef)</td></tr></thead><tr><td>60029</td><td>150164</td><td>51901</td><td>21863</td><td>30038</td><td>10942</td><td>30027</td><td>1780901</td><td>1694462</td><td>42773</td><td>20038</td><td>40036</td><td>20038</td><td>70063</td><td>25452</td><td>30000</td><td>30014</td></tr><tr><td>60028</td><td>150084</td><td>55479</td><td>25472</td><td>30007</td><td>12747</td><td>30003</td><td>1781360</td><td>1694551</td><td>42740</td><td>20022</td><td>40004</td><td>20022</td><td>70007</td><td>25453</td><td>30000</td><td>30010</td></tr><tr><td>60024</td><td>150048</td><td>55464</td><td>25463</td><td>30001</td><td>12737</td><td>30003</td><td>1781348</td><td>1694537</td><td>42740</td><td>20022</td><td>40004</td><td>20020</td><td>70000</td><td>25455</td><td>30000</td><td>30010</td></tr><tr><td>60024</td><td>150048</td><td>55465</td><td>25465</td><td>30000</td><td>12737</td><td>30000</td><td>1781348</td><td>1694523</td><td>42737</td><td>20020</td><td>40000</td><td>20020</td><td>70000</td><td>25455</td><td>30000</td><td>30010</td></tr><tr><td>60024</td><td>150048</td><td>55465</td><td>25465</td><td>30000</td><td>12737</td><td>30042</td><td>1729564</td><td>1694443</td><td>42418</td><td>20048</td><td>40056</td><td>20038</td><td>70063</td><td>25458</td><td>30000</td><td>30014</td></tr><tr><td>60024</td><td>150048</td><td>55465</td><td>25465</td><td>30000</td><td>12737</td><td>30000</td><td>1781348</td><td>1694523</td><td>42737</td><td>20020</td><td>40000</td><td>20020</td><td>70000</td><td>25455</td><td>30000</td><td>30010</td></tr><tr><td>60024</td><td>150048</td><td>55465</td><td>25465</td><td>30000</td><td>12737</td><td>30000</td><td>1781348</td><td>1694525</td><td>42737</td><td>20020</td><td>40000</td><td>20048</td><td>70098</td><td>22713</td><td>30000</td><td>30012</td></tr><tr><td>60028</td><td>150088</td><td>55478</td><td>25460</td><td>30018</td><td>12747</td><td>30000</td><td>1781779</td><td>1695069</td><td>42737</td><td>20020</td><td>40000</td><td>20020</td><td>70000</td><td>25445</td><td>30000</td><td>30010</td></tr><tr><td>60024</td><td>150080</td><td>55455</td><td>25455</td><td>30000</td><td>12737</td><td>30033</td><td>1710395</td><td>1694755</td><td>42270</td><td>20042</td><td>40044</td><td>20038</td><td>70063</td><td>25454</td><td>30000</td><td>30014</td></tr><tr><td>60028</td><td>150052</td><td>55484</td><td>25466</td><td>30018</td><td>12746</td><td>30027</td><td>1780865</td><td>1694424</td><td>42773</td><td>20038</td><td>40036</td><td>20038</td><td>70063</td><td>25456</td><td>30000</td><td>30014</td></tr></table></div></div></div></div></body></html>